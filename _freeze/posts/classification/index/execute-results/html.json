{
  "hash": "f256c159194b149ac2e5c78a9983a8f0",
  "result": {
    "markdown": "---\ntitle: \"Classification\"\nauthor: \"Youwei Chen\"\ndate: \"2023-11-28\"\ncategories: [NLP, code, sentiment analysis, classification]\n---\n\n### 1. Introduction:\n\nThis blog will utilize both rule-based VADER sentiment analysis tool and machine learning pre-trained RoBERTa model to perform analysis of sentiment in Amazon reviews. It will apply sentiment analysis models to classify reviews into categories such as \"positive\", \"neutral\", and \"negative\". The visualizations at end will also show the relationship between different sentiment classifiers.\n\n### 2. Import the libraries:\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport nltk\nfrom nltk.sentiment import SentimentIntensityAnalyzer\nfrom tqdm.notebook import tqdm \nfrom scipy.special import softmax\nfrom transformers import AutoTokenizer, AutoModelForSequenceClassification\n```\n:::\n\n\n### 3. Load the amazon_reviews csv file:\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\namazon_df = pd.read_csv(\"amazon_reviews.csv\")\n```\n:::\n\n\n### 4. Bar plot to show the number of reviews in different ratings:\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\nvis = amazon_df['rating'].value_counts().sort_index().plot(kind='bar', title='number of reviews vs. ratings', figsize=(10,5))\nvis.set_xlabel(\"Review ratings\")\nvis.set_ylabel(\"number of reviews\")\nvis.set_xticklabels(vis.get_xticklabels(), rotation=1)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-4-output-1.png){width=825 height=450}\n:::\n:::\n\n\n### 5. Apply SentimentIntensityAnalyzer:\n\nThe code below uses the VADER sentiment analysis tool from NLTK to give scores for each Amazon reviews. Based on the scores, the new column **sentiment** will classify 'negative', 'positive', 'neutral' based on the scores. The dataframe **vader_nltk** stores polarity scores and sentiment labels.\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\ndef get_sentiment(score):\n    if score < -0.05:\n        return 'negative'\n    elif score > 0.05:\n        return 'positive'\n    else:\n        return 'neutral'\n\nsia = SentimentIntensityAnalyzer()\nres = {}\nfor i, row in tqdm(amazon_df.iterrows(), total=len(amazon_df)):\n    text = str(row['reviewText'])\n    myid = row['id']\n    polarity_scores = sia.polarity_scores(text)\n    res[myid] = {**polarity_scores, 'sentiment': get_sentiment(polarity_scores['compound'])}\n\nvader_nltk = pd.DataFrame.from_dict(res, orient='index').reset_index()\nvader_nltk.columns = ['id'] + list(vader_nltk.columns[1:])\nvader_nltk = pd.merge(vader_nltk, amazon_df, on='id', how='left')\nvader_nltk.head()\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"598357081a3246f5882b424e28f21e65\",\"version_major\":2,\"version_minor\":0,\"quarto_mimetype\":\"application/vnd.jupyter.widget-view+json\"}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>id</th>\n      <th>neg</th>\n      <th>neu</th>\n      <th>pos</th>\n      <th>compound</th>\n      <th>sentiment</th>\n      <th>reviewerName</th>\n      <th>rating</th>\n      <th>reviewText</th>\n      <th>reviewTime</th>\n      <th>day_diff</th>\n      <th>helpful_yes</th>\n      <th>helpful_no</th>\n      <th>total_vote</th>\n      <th>score_pos_neg_diff</th>\n      <th>score_average_rating</th>\n      <th>wilson_lower_bound</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>0.688</td>\n      <td>0.312</td>\n      <td>0.000</td>\n      <td>-0.2960</td>\n      <td>negative</td>\n      <td>NaN</td>\n      <td>4.0</td>\n      <td>No issues.</td>\n      <td>2014-07-23</td>\n      <td>138</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>0.077</td>\n      <td>0.923</td>\n      <td>0.000</td>\n      <td>-0.3089</td>\n      <td>negative</td>\n      <td>1K3</td>\n      <td>4.0</td>\n      <td>it works as expected. I should have sprung for...</td>\n      <td>2012-12-23</td>\n      <td>715</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>11</td>\n      <td>0.000</td>\n      <td>1.000</td>\n      <td>0.000</td>\n      <td>0.0000</td>\n      <td>neutral</td>\n      <td>98020</td>\n      <td>3.0</td>\n      <td>It works, but file writes are a bit slower tha...</td>\n      <td>2013-11-20</td>\n      <td>383</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>32</td>\n      <td>0.088</td>\n      <td>0.774</td>\n      <td>0.138</td>\n      <td>0.5255</td>\n      <td>positive</td>\n      <td>Abdulrahman J. Alrashed \"dr34m3r\"</td>\n      <td>1.0</td>\n      <td>I bought 2 of those SanDisk 32 GB microSD , us...</td>\n      <td>2013-03-08</td>\n      <td>640</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>33</td>\n      <td>0.000</td>\n      <td>0.632</td>\n      <td>0.368</td>\n      <td>0.9153</td>\n      <td>positive</td>\n      <td>Abel Feliciano \"Ace Master\"</td>\n      <td>4.0</td>\n      <td>The memory card is an excellent condition and ...</td>\n      <td>2012-11-09</td>\n      <td>759</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### 6. the boxplot to show the distribution of 'neg', 'neu', 'pos' for each rating.\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\nfig, axs = plt.subplots(1, 3, figsize=(15,5))\nsns.boxplot(data=vader_nltk, x='rating', y='neg', ax=axs[0])\nsns.boxplot(data=vader_nltk, x='rating', y='neu', ax=axs[1])\nsns.boxplot(data=vader_nltk, x='rating', y='pos', ax=axs[2])\naxs[0].set_title('Negative sentiment')\naxs[1].set_title('Neutral sentiment')\naxs[2].set_title('Positive sentiment')\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-6-output-1.png){width=1430 height=470}\n:::\n:::\n\n\n### 7. Hugging Face Transformers to load a pre-trained model:\n\nIt sets up a sentiment analysis model based on RoBERTa architecture for analyzing the Amazon reviews.\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\nMODEL = \"cardiffnlp/twitter-roberta-base-sentiment\"\ntokenizer = AutoTokenizer.from_pretrained(MODEL)\nmodel = AutoModelForSequenceClassification.from_pretrained(MODEL)\n```\n:::\n\n\n### 8. VADER Sentiment analysis vs. RoBERTa Model Sentiment Analysis:\n\n##### (1). VADER score about the review at index 30:\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\nexample_review = amazon_df['reviewText'][30]\nexample_review\nprint(\"Vader sentiment analysis scores for the review at index 30 is \", sia.polarity_scores(example_review))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nVader sentiment analysis scores for the review at index 30 is  {'neg': 0.0, 'neu': 0.886, 'pos': 0.114, 'compound': 0.6249}\n```\n:::\n:::\n\n\n##### (2).RoBERTa score about the review at index 30:\n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\nencoded_review = tokenizer(example_review, return_tensors='pt')\noutput = model(**encoded_review)\nscores = output[0][0].detach().numpy()\nscores = softmax(scores)\nscores_dict = {\n  'roberta_neg': scores[0],\n  'roberta_neu': scores[1],\n  'roberta_pos': scores[2]\n}\n\nprint(\"Roberta scores for the review at index 30 is \", scores_dict)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRoberta scores for the review at index 30 is  {'roberta_neg': 0.25840575, 'roberta_neu': 0.34866926, 'roberta_pos': 0.39292496}\n```\n:::\n:::\n\n\n### 9. RoBERTa score and VADER score Integration:\n\nThe **res** dictionary combines and contains both the VADER sentiment analysis result and the pre-trained model RoBERTa model's result.\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\ndef roberta_scores(example_review):\n  encoded_review = tokenizer(example_review, return_tensors='pt')\n  output = model(**encoded_review)\n  scores = output[0][0].detach().numpy()\n  scores = softmax(scores)\n  scores_dict = {\n    'roberta_neg': scores[0],\n    'roberta_neu': scores[1],\n    'roberta_pos': scores[2]\n  }\n  return scores_dict\nres = {}\nfor i, row in tqdm(amazon_df.iterrows(), total=len(amazon_df)):\n    try:\n        review = row['reviewText']\n        review_id = row['id']\n        if isinstance(review, str):\n            vader_result = sia.polarity_scores(review)\n            vader_result2 = {f\"vader_{key}\": value for key, value in vader_result.items()}\n            roberta_result = roberta_scores(review)\n            res[review_id] = {**vader_result2, **roberta_result}\n        else:\n            print(f'Skipped id: {review_id} due to non-string review')\n    except RuntimeError:\n        continue\ndict_list = list(res.items())[:5]\nfor item in dict_list:\n    print(item)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"aad275e0d2064addbe41de6fe4138f12\",\"version_major\":2,\"version_minor\":0,\"quarto_mimetype\":\"application/vnd.jupyter.widget-view+json\"}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n(0, {'vader_neg': 0.688, 'vader_neu': 0.312, 'vader_pos': 0.0, 'vader_compound': -0.296, 'roberta_neg': 0.07495943, 'roberta_neu': 0.5892151, 'roberta_pos': 0.33582547})\n(2, {'vader_neg': 0.077, 'vader_neu': 0.923, 'vader_pos': 0.0, 'vader_compound': -0.3089, 'roberta_neg': 0.42375654, 'roberta_neu': 0.4483106, 'roberta_pos': 0.12793283})\n(11, {'vader_neg': 0.0, 'vader_neu': 1.0, 'vader_pos': 0.0, 'vader_compound': 0.0, 'roberta_neg': 0.2745669, 'roberta_neu': 0.4989962, 'roberta_pos': 0.22643691})\n(32, {'vader_neg': 0.088, 'vader_neu': 0.774, 'vader_pos': 0.138, 'vader_compound': 0.5255, 'roberta_neg': 0.54347664, 'roberta_neu': 0.3384522, 'roberta_pos': 0.118071124})\n(33, {'vader_neg': 0.0, 'vader_neu': 0.632, 'vader_pos': 0.368, 'vader_compound': 0.9153, 'roberta_neg': 0.0029975341, 'roberta_neu': 0.026594352, 'roberta_pos': 0.97040814})\n```\n:::\n:::\n\n\n### 10. Merge into dataframe:\n\n::: {.cell execution_count=10}\n``` {.python .cell-code}\nmodel_df = pd.DataFrame(res).T\nmodel_df = model_df.reset_index().rename(columns={'index':'id'})\nmodel_df = model_df.merge(amazon_df, how='left')\nmodel_df.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>id</th>\n      <th>vader_neg</th>\n      <th>vader_neu</th>\n      <th>vader_pos</th>\n      <th>vader_compound</th>\n      <th>roberta_neg</th>\n      <th>roberta_neu</th>\n      <th>roberta_pos</th>\n      <th>reviewerName</th>\n      <th>rating</th>\n      <th>reviewText</th>\n      <th>reviewTime</th>\n      <th>day_diff</th>\n      <th>helpful_yes</th>\n      <th>helpful_no</th>\n      <th>total_vote</th>\n      <th>score_pos_neg_diff</th>\n      <th>score_average_rating</th>\n      <th>wilson_lower_bound</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>0.688</td>\n      <td>0.312</td>\n      <td>0.000</td>\n      <td>-0.2960</td>\n      <td>0.074959</td>\n      <td>0.589215</td>\n      <td>0.335825</td>\n      <td>NaN</td>\n      <td>4.0</td>\n      <td>No issues.</td>\n      <td>2014-07-23</td>\n      <td>138</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>0.077</td>\n      <td>0.923</td>\n      <td>0.000</td>\n      <td>-0.3089</td>\n      <td>0.423757</td>\n      <td>0.448311</td>\n      <td>0.127933</td>\n      <td>1K3</td>\n      <td>4.0</td>\n      <td>it works as expected. I should have sprung for...</td>\n      <td>2012-12-23</td>\n      <td>715</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>11</td>\n      <td>0.000</td>\n      <td>1.000</td>\n      <td>0.000</td>\n      <td>0.0000</td>\n      <td>0.274567</td>\n      <td>0.498996</td>\n      <td>0.226437</td>\n      <td>98020</td>\n      <td>3.0</td>\n      <td>It works, but file writes are a bit slower tha...</td>\n      <td>2013-11-20</td>\n      <td>383</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>32</td>\n      <td>0.088</td>\n      <td>0.774</td>\n      <td>0.138</td>\n      <td>0.5255</td>\n      <td>0.543477</td>\n      <td>0.338452</td>\n      <td>0.118071</td>\n      <td>Abdulrahman J. Alrashed \"dr34m3r\"</td>\n      <td>1.0</td>\n      <td>I bought 2 of those SanDisk 32 GB microSD , us...</td>\n      <td>2013-03-08</td>\n      <td>640</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>33</td>\n      <td>0.000</td>\n      <td>0.632</td>\n      <td>0.368</td>\n      <td>0.9153</td>\n      <td>0.002998</td>\n      <td>0.026594</td>\n      <td>0.970408</td>\n      <td>Abel Feliciano \"Ace Master\"</td>\n      <td>4.0</td>\n      <td>The memory card is an excellent condition and ...</td>\n      <td>2012-11-09</td>\n      <td>759</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### 11. Heatmap to show the relationship between VADER Sentiment analysis tool and RoBERTa training model:\n\nThe heatmap is applied here to explore the correlation between the VADER model classifications and the RoBERTa model classifications.\n\n::: {.cell execution_count=11}\n``` {.python .cell-code}\nplt.figure(figsize=(4, 3))\ncorrelation = model_df[['vader_neg', 'vader_neu', 'vader_pos', 'roberta_neg', 'roberta_neu', 'roberta_pos']].corr()\nsns.heatmap(correlation, annot=True, cmap='coolwarm')\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-12-output-1.png){width=369 height=277}\n:::\n:::\n\n\nFrom the heatmap shown above, the correlation coefficient of two models' relationship:\n\n1.  **vader_neg - roberta_neg:** 0.35\n2.  **vader_neu - roberta_neu:** 0.36\n3.  **vader_pos - roberta_pos:** 0.5\n\n",
    "supporting": [
      "index_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n<script src=\"https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js\" crossorigin=\"anonymous\"></script>\n"
      ],
      "include-after-body": [
        "<script type=application/vnd.jupyter.widget-state+json>\n{\"state\":{\"072fffac039b4f0c8cec816cbc67f389\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"0f805ae8ba2f432e8962a2ab0fda77c4\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"195e68b6aade441e966e5c018d540dc1\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"success\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_63381471dd9846bb86493056bb2f48ab\",\"max\":2284,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_f81833a36c6a4cc6b39198e8eb0d16fb\",\"tabbable\":null,\"tooltip\":null,\"value\":2284}},\"1bbaf223ed0f4aef98ed82b11fee4c4b\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_99caef105d8c4dc5aaa185becd196aeb\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_91441433da574911920143cbaa6bbb10\",\"tabbable\":null,\"tooltip\":null,\"value\":\"100%\"}},\"2fe7a9a08e544edd8b4eed92d955f33d\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":null,\"description_width\":\"\"}},\"3c00ad77b91f4865890e8885800ae916\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"42d4d4a051a04e18af611ac4eb268eff\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_ac4db50c5eeb48bcb5183276bd1a18c6\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_0f805ae8ba2f432e8962a2ab0fda77c4\",\"tabbable\":null,\"tooltip\":null,\"value\":\"100%\"}},\"553f8176b10e424cb523a31a498b94be\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"success\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_f8eb21f58fed42c4a47278e25edb64f3\",\"max\":2284,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_2fe7a9a08e544edd8b4eed92d955f33d\",\"tabbable\":null,\"tooltip\":null,\"value\":2284}},\"598357081a3246f5882b424e28f21e65\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HBoxModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HBoxModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HBoxView\",\"box_style\":\"\",\"children\":[\"IPY_MODEL_1bbaf223ed0f4aef98ed82b11fee4c4b\",\"IPY_MODEL_195e68b6aade441e966e5c018d540dc1\",\"IPY_MODEL_9aaa856e34bd4a4c8a24d6207a4e1ceb\"],\"layout\":\"IPY_MODEL_c811683a2c4c425f86feefe9dcaa16e9\",\"tabbable\":null,\"tooltip\":null}},\"63381471dd9846bb86493056bb2f48ab\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"66c035f8882c42d8bf1e4e2a848fda49\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"8ba3f9dbc8fd4e12a98291176cc2d64b\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"91441433da574911920143cbaa6bbb10\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"99caef105d8c4dc5aaa185becd196aeb\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"9aaa856e34bd4a4c8a24d6207a4e1ceb\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_d77c1ebfc5784bab921aea4a2e8e5482\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_8ba3f9dbc8fd4e12a98291176cc2d64b\",\"tabbable\":null,\"tooltip\":null,\"value\":\" 2284/2284 [00:03&lt;00:00, 620.71it/s]\"}},\"aad275e0d2064addbe41de6fe4138f12\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HBoxModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HBoxModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HBoxView\",\"box_style\":\"\",\"children\":[\"IPY_MODEL_42d4d4a051a04e18af611ac4eb268eff\",\"IPY_MODEL_553f8176b10e424cb523a31a498b94be\",\"IPY_MODEL_ed70bf90f94d4ebb890df270a4759495\"],\"layout\":\"IPY_MODEL_3c00ad77b91f4865890e8885800ae916\",\"tabbable\":null,\"tooltip\":null}},\"ac4db50c5eeb48bcb5183276bd1a18c6\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"c811683a2c4c425f86feefe9dcaa16e9\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"d77c1ebfc5784bab921aea4a2e8e5482\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"ed70bf90f94d4ebb890df270a4759495\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_66c035f8882c42d8bf1e4e2a848fda49\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_072fffac039b4f0c8cec816cbc67f389\",\"tabbable\":null,\"tooltip\":null,\"value\":\" 2284/2284 [12:11&lt;00:00,  2.11it/s]\"}},\"f81833a36c6a4cc6b39198e8eb0d16fb\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":null,\"description_width\":\"\"}},\"f8eb21f58fed42c4a47278e25edb64f3\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}}},\"version_major\":2,\"version_minor\":0}\n</script>\n"
      ]
    }
  }
}